<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>blog.najashark.net</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-dark.css" rel="stylesheet" />
  <link rel="icon" type="image/png" href="/images/favicon.png">

</head>

<body>



  <header id="header">
    <h1><a href="/">blog.najashark.net</a></h1>
    <p>post-it notes</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
		  <img class="home-logo" src="/images/favicon.png" alt="logo">
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/najashark">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      

	<article class="post">

		
			<h1><a href="/2017/08/18/bumblebee-on-lenovo-y480-nvidia-gt-650m/">Bumblebee on a Lenovo Y480 [Nvidia GT 650M] with XUbuntu/Ubuntu 16.04.3 LTS </a></h1>
		

		<div class="post-content">I follow this guide from this <a href="http://lenovolinux.blogspot.my/2016/05/bumblebee-on-lenovo-t440p-nvidia-gt.html" target="_blank">blog</a>, but using a testing repo because it has the latest patch for lenovo laptop<br /><br />here the summary of it<br /><br /><br /><script src="https://gist.github.com/najashark/864931436dbcfe35053003f6f8e92115.js"></script></div>

	</article>



	<article class="post">

		
			<h1><a href="/2017/02/20/wargamesmy-2017-monthly-challenge/">Wargames.my 2017 monthly Challenge (January)</a></h1>
		

		<div class="post-content"><div class="MsoNormal"><span lang="EN-US">The Question.<o:p></o:p></span></div><div class="MsoNormal"><i><span lang="EN-US">For the January 2017 Challenge, take a look at this<o:p></o:p></span></i></div><div class="MsoNormal"><i><span lang="EN-US">+++ bankgroup.us +++<o:p></o:p></span></i></div><div class="MsoNormal"><i><span lang="EN-US">The hint from our crew : The fundamental.<o:p></o:p></span></i></div><div class="MsoNormal"><i><span lang="EN-US">Find the flag and make a good readable writeup for our crew. Send it at wgmy2016@gmail.com<o:p></o:p></span></i></div><div style="border-bottom: solid windowtext 1.0pt; border: none; mso-border-bottom-alt: solid windowtext .75pt; mso-element: para-border-div; padding: 0cm 0cm 1.0pt 0cm;"><div class="MsoNormal" style="border: none; mso-border-bottom-alt: solid windowtext .75pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm; padding: 0cm;"><i><span lang="EN-US">Have fun and enjoy! Do note that, excessive usage of any automated scanner is not allowed!.<o:p></o:p></span></i></div><div class="MsoNormal" style="border: none; mso-border-bottom-alt: solid windowtext .75pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm; padding: 0cm;"><br /></div></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">Because of the hint fundamental<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US">So I try, nslookup, whois, and dig<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US">No interesting outcome for nslookup and whois, but something interesting on dig<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US">I tried dig bankgroup.us TXT<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">aj69@srv:~# dig bankgroup.us +noall +answer ANY<o:p></o:p></span></span></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">; &lt;&lt;&gt;&gt; DiG 9.9.5-3ubuntu0.10-Ubuntu &lt;&lt;&gt;&gt; bankgroup.us +noall +answer ANY<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">;; global options: +cmd<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">bankgroup.us.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3788&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp; "Please stop asking for ANY" "See draft-ietf-dnsop-refuse-any"</span><o:p></o:p></span></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">It warn not to use ANY, then I tried straight to the TXT section hope will find something on that section<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">root@srv:~# dig bankgroup.us +noall +answer TXT<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">; &lt;&lt;&gt;&gt; DiG 9.9.5-3ubuntu0.10-Ubuntu &lt;&lt;&gt;&gt; bankgroup.us +noall +answer TXT<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">;; global options: +cmd<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">bankgroup.us.&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;299&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TXT&nbsp;&nbsp;&nbsp;&nbsp; "N3q8ryccAASpcFcnsAAAAAAAAAA1AAAAAAAAAOOaNWJd7k4PCFF/aUiqAKhV/q9uV8Qm51pm+GJ7TUy7ofBPHvcz6ZcmIeRv6dH3Ts/mpF6hHldwnakFMsrole1lTb4vjz0jbyEyGW69sZb0d/p5E5UPEJFitc1SUu5AWOII4d2kOUsaO+8yqB4QBrlzZnzzRTXncrDJMn7GYY/Zm4DuLTlQyisTAm072O27wJS3ChzEPcozQ+htBTk4n7T1+YA" "Wt36dV7hb7R3z96Pm9VDiXhcGMAEJgIAABwsBAAIkBvEHAQpTBzOpWSfwSpXaIwMBAQVdABAAAAEADHyAlgoB4Q5axwAA"<o:p></o:p></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">bankgroup.us.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 299&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TXT&nbsp;&nbsp;&nbsp;&nbsp; "v=spf1 mx a ip4:8.8.8.8/24 a:nasikakwok include:domainengkau -all"</span><o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span></span></div><div class="MsoNormal"><span lang="EN-US">That is some interesting part, <b>base64</b> and <b>nasikakwok</b> also <b>domainengkau<o:p></o:p></b></span></div><div class="MsoNormal"><span lang="EN-US">Base64 is in 2 part so I just join them and decode it to hexadecimal then save it as ayam2.7z file<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-ihzE1vGRJjw/WKqpAHbIopI/AAAAAAAAFRw/4rzZIPdnKtsLV2vi2tofdNk3cmrlNY9OgCLcB/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="205" src="https://4.bp.blogspot.com/-ihzE1vGRJjw/WKqpAHbIopI/AAAAAAAAFRw/4rzZIPdnKtsLV2vi2tofdNk3cmrlNY9OgCLcB/s400/1.png" width="400" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"  coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"  filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>  <v:f eqn="if lineDrawn pixelLineWidth 0"/>  <v:f eqn="sum @0 1 0"/>  <v:f eqn="sum 0 0 @1"/>  <v:f eqn="prod @2 1 2"/>  <v:f eqn="prod @3 21600 pixelWidth"/>  <v:f eqn="prod @3 21600 pixelHeight"/>  <v:f eqn="sum @0 0 1"/>  <v:f eqn="prod @6 1 2"/>  <v:f eqn="prod @7 21600 pixelWidth"/>  <v:f eqn="sum @8 21600 0"/>  <v:f eqn="prod @7 21600 pixelHeight"/>  <v:f eqn="sum @10 21600 0"/> </v:formulas> <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/> <o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="Picture_x0020_1" o:spid="_x0000_i1026" type="#_x0000_t75"  style='width:468pt;height:240.75pt;visibility:visible;mso-wrap-style:square'> <v:imagedata src="file:///C:/Users/ggrip/AppData/Local/Temp/msohtmlclip1/01/clip_image001.png"   o:title=""/></v:shape><![endif]--><!--[if !vml]--><!--[endif]--><span lang="EN-US"><o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US">Tried opening the files, its password protected! duh!<o:p></o:p></span></div><div class="MsoNormal"><!--[if gte vml 1]><v:shape id="Picture_x0020_2"  o:spid="_x0000_i1025" type="#_x0000_t75" style='width:423pt;height:266.25pt;  visibility:visible;mso-wrap-style:square'> <v:imagedata src="file:///C:/Users/ggrip/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png"   o:title=""/></v:shape><![endif]--><!--[if !vml]--><!--[endif]--><span lang="EN-US"><o:p></o:p></span></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-fHwUqsNiq1M/WKqpE5ZUmWI/AAAAAAAAFR0/UvlKEpLs60gvah6smloY_V5cp4W2MCEIwCLcB/s1600/2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="251" src="https://1.bp.blogspot.com/-fHwUqsNiq1M/WKqpE5ZUmWI/AAAAAAAAFR0/UvlKEpLs60gvah6smloY_V5cp4W2MCEIwCLcB/s400/2.png" width="400" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal">try all possible password but that's not it, so i go the the main domain, which was a gitlab community site, after poking around, I found one repository called <b>username/flag</b>, but still failed</div><div class="MsoNormal"><br /></div><div class="MsoNormal">other than that, I got the original IP of the website which was under the cloudflare if you ping it directly.&nbsp;</div><div class="MsoNormal"><br /></div><div class="MsoNormal">Doing some port scanning to the IP just got some closed port on SSH and ftp if I'm not mistaken.</div><div class="MsoNormal">So all was blank to me.</div><div class="MsoNormal"><br /></div><div class="MsoNormal">Maybe some of you that got it, can tell me how to get the password much be appreciated! :D</div><div class="MsoNormal"><br /></div><div class="MsoNormal">UPDATE!<br /><br />seems that someone has solve this question [<a href="https://gist.github.com/anonymous/272e98c7d4d4502ee967368a11f45347" target="_blank">POC</a>], the zip file needs to be crack using rockyou wordlist!<br />maybe no luck for me. So after password was found, you will get the flag.&nbsp;</div></div>

	</article>



	<article class="post">

		
			<h1><a href="/2016/12/04/writeup-kpmg-2016-re1-poland/">[Writeup] KPMG 2016 - re1 Poland</a></h1>
		

		<div class="post-content">Here is some explaination on re1_4830bb9eb4ec526e999df30852e3cb9f.exe on KPMG Security Challenge 2016.<br />Basically re1 and re2 use very similar algorithm which<br />- get 32character<br />- compared part by part (8 character each)<br />- checker on full flag on last part<br /><br />I will not explain in details because it is not a complex algorithm<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-Biqi2IkTqBA/WEPpodHHGcI/AAAAAAAAFF0/lNKmS8lnbeY9DkRvEhv5VfZ8CJhWXOthACEw/s1600/132char.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="188" src="https://4.bp.blogspot.com/-Biqi2IkTqBA/WEPpodHHGcI/AAAAAAAAFF0/lNKmS8lnbeY9DkRvEhv5VfZ8CJhWXOthACEw/s640/132char.PNG" width="640" /></a></div><br />here you can see it comparing ECX with 0x20, it means that it want 32character to proceed<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-NW5BSNe1jOI/WEPpo3Rx7hI/AAAAAAAAFF4/HU9KV0VoNAAiS51tXlCLP0l3-XXcNXdswCLcB/s1600/2input.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="211" src="https://2.bp.blogspot.com/-NW5BSNe1jOI/WEPpo3Rx7hI/AAAAAAAAFF4/HU9KV0VoNAAiS51tXlCLP0l3-XXcNXdswCLcB/s400/2input.PNG" width="400" /></a></div>&nbsp;so we insert 32 character to the prompt and press ENTER then observe it in debugger.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-3HVjaKyxS1w/WEPpo4UL2OI/AAAAAAAAFF8/peNVr8V-UxI0sfm26pFs5llBFQeA7shbACLcB/s1600/3loop.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="174" src="https://1.bp.blogspot.com/-3HVjaKyxS1w/WEPpo4UL2OI/AAAAAAAAFF8/peNVr8V-UxI0sfm26pFs5llBFQeA7shbACLcB/s640/3loop.PNG" width="640" /></a></div>when you reach until here you can see on register<br />ECX-&gt;password<br />EAX-&gt;our input<br /><br />so you get a part of the password, step until you find all 4 part of the password.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-wvqm39S4kS4/WEPppXVpJkI/AAAAAAAAFGA/U-LM-nJ3CWUXpearm9dYA0wEpZXggaUGACLcB/s1600/4flag.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="284" src="https://1.bp.blogspot.com/-wvqm39S4kS4/WEPppXVpJkI/AAAAAAAAFGA/U-LM-nJ3CWUXpearm9dYA0wEpZXggaUGACLcB/s640/4flag.PNG" width="640" /></a></div><br />here you can get your full flag if all the 4 part checker is valid.<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-kBU46cTU5Mc/WEPppmX4hrI/AAAAAAAAFGE/SG5ZRzxnbskDP1_8-bDpiGDJJN8X23TqQCLcB/s1600/answer.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="166" src="https://3.bp.blogspot.com/-kBU46cTU5Mc/WEPppmX4hrI/AAAAAAAAFGE/SG5ZRzxnbskDP1_8-bDpiGDJJN8X23TqQCLcB/s640/answer.PNG" width="640" /></a></div>Test it to confirm your flag.<br /><br /><span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">7h15 15 4n 345y 0n3!<br />Please enter the Flag:<br />42*am1*G50L[=H33~g=%a11Bq27KOO2a<br />Congratulations! It is correct... The flag is KPMG{42*am1*G50L[=H33~g=%a11Bq27KOO2a}</span></span> <br /><br />Thats all</div>

	</article>



	<article class="post">

		
			<h1><a href="/2016/12/01/writeup-kpmg-2016-guessmypassword-congo/"> [Writeup] KPMG 2016 - guess_my_password congo</a></h1>
		

		<div class="post-content"><div style="text-align: center;">Here is some explaination on guess_my_password.exe on KPMG Security Challenge 2016.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-j48k__O9HKc/WEBDsWBd-bI/AAAAAAAAFFU/meL4Hd9ikUIcFT5GsfE3wrkgi_vuYFwhgCLcB/s1600/64bit.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="191" src="https://4.bp.blogspot.com/-j48k__O9HKc/WEBDsWBd-bI/AAAAAAAAFFU/meL4Hd9ikUIcFT5GsfE3wrkgi_vuYFwhgCLcB/s400/64bit.PNG" width="400" />&nbsp;</a></div><div style="text-align: center;">&nbsp;so its PE64</div><div style="text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-JFbZb3gXfFI/WEBDs-dDULI/AAAAAAAAFFc/6sRAynQ2LV4MIziAVARs4ejFh3ycTYe2gCLcB/s1600/b64lookalike.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="210" src="https://1.bp.blogspot.com/-JFbZb3gXfFI/WEBDs-dDULI/AAAAAAAAFFc/6sRAynQ2LV4MIziAVARs4ejFh3ycTYe2gCLcB/s400/b64lookalike.PNG" width="400" />&nbsp;</a></div><div class="separator" style="clear: both; text-align: center;">looks like base64 string try decode it, i get nothing, so lets dive to the code again</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-l45fLL6KFkc/WEBDsv_ih6I/AAAAAAAAFFY/gLKy8vAMVDYVoWkFcYW6SOXx4MOC_j9uQCEw/s1600/customb64string.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="270" src="https://4.bp.blogspot.com/-l45fLL6KFkc/WEBDsv_ih6I/AAAAAAAAFFY/gLKy8vAMVDYVoWkFcYW6SOXx4MOC_j9uQCEw/s640/customb64string.PNG" width="640" /></a></div><div style="text-align: left;">&nbsp;after some time i found it is a custom base64 with alphabet<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">0123456789qazwsxedcrfvtgbyhnujmikolpPOLIKUJMYHNTGBRFVEDCWSXQAZ+/</span></div><div style="text-align: left;"><br /><span style="font-family: &quot;courier new&quot;,&quot;courier&quot;,monospace;">I</span> found this website <span style="color: blue;"><a href="https://www.malwaretracker.com/decoder_base64.php" target="_blank">HERE</a></span></div><div style="text-align: left;">and paste the custom alphabet and decode the sting back and you get the flag</div><div style="text-align: left;"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">KPMG{th!5_is_to0_5impL3_RE} </span></div><div style="text-align: center;"><br /></div></div>

	</article>



	<article class="post">

		
			<h1><a href="/2016/11/27/writeup-kpmg16-re2-japan/">[Writeup] KPMG 2016 - re2 Japan </a></h1>
		

		<div class="post-content"><div class="separator" style="clear: both; text-align: center;"></div>Here is some explaination on re2_8dbeee84fa0ec05fadda075508c13be0.exe on KPMG Security Challenge 2016. I didn't manage to solve it on the competition day, unlucky me.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-mPpIZe-i8XY/WDrG03Xnx6I/AAAAAAAAFEQ/QNCdpJZxJgUyf0NmqTtZURiF2IwZPHf1QCLcB/s1600/0intro.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="187" src="https://2.bp.blogspot.com/-mPpIZe-i8XY/WDrG03Xnx6I/AAAAAAAAFEQ/QNCdpJZxJgUyf0NmqTtZURiF2IwZPHf1QCLcB/s400/0intro.PNG" width="400" /></a></div>&nbsp;So its packed with UPX, easy right? just unpack it.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-N2iSNYHpev0/WDrG3vCiafI/AAAAAAAAFEU/QCYSzhfGbKYA2ZAF5GMDS9vgA6L4_ZYUwCEw/s1600/1upx.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="72" src="https://3.bp.blogspot.com/-N2iSNYHpev0/WDrG3vCiafI/AAAAAAAAFEU/QCYSzhfGbKYA2ZAF5GMDS9vgA6L4_ZYUwCEw/s400/1upx.PNG" width="400" /></a></div>Ok successfully unpack, no worries. Try run it.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qytPuiOevNc/WDrG3p5HNhI/AAAAAAAAFEY/77nfAIeuhLAy61Zrlc4yH8Zsm9uUC4LWgCLcB/s1600/2crash.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="232" src="https://1.bp.blogspot.com/-qytPuiOevNc/WDrG3p5HNhI/AAAAAAAAFEY/77nfAIeuhLAy61Zrlc4yH8Zsm9uUC4LWgCLcB/s320/2crash.PNG" width="320" /></a></div>&nbsp;Oh no! stopped working. try load in IDA if we see something in it.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-Wfxl7QWIfEE/WDrG4Iphb6I/AAAAAAAAFEg/-nUHpw4Y5ascsw5o73FLC_WxTRKu3KTfQCLcB/s1600/3ida.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="280" src="https://3.bp.blogspot.com/-Wfxl7QWIfEE/WDrG4Iphb6I/AAAAAAAAFEg/-nUHpw4Y5ascsw5o73FLC_WxTRKu3KTfQCLcB/s400/3ida.PNG" width="400" /></a></div>&nbsp;Looks like we see something like we run the original binary, from here you can get the algo which is compared part by part from memory with our input<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-4u4PkmysCzA/WDrG4RHwmHI/AAAAAAAAFFE/a_X7lE-cpwA6MoDw3d3ueNMu9rLYIUY1wCEw/s1600/4ida.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-4u4PkmysCzA/WDrG4RHwmHI/AAAAAAAAFFE/a_X7lE-cpwA6MoDw3d3ueNMu9rLYIUY1wCEw/s1600/4ida.PNG" /></a></div>we can also see that our input is calculated and check to matching 32 char sting, if not you get the sayonara.<br /><br />So the trick is either manual unpacking the upx or attached it to the debugger to get the answer from memory, my way is attaching the binary, run first and attached it.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-oFG4c-94Wjg/WDrG41tBDbI/AAAAAAAAFFE/tb-quv0-RSc4-2OzpIe_j3zhRoUvYH-8gCEw/s1600/6input.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="186" src="https://1.bp.blogspot.com/-oFG4c-94Wjg/WDrG41tBDbI/AAAAAAAAFFE/tb-quv0-RSc4-2OzpIe_j3zhRoUvYH-8gCEw/s640/6input.PNG" width="640" /></a></div>run it and put 32 char string to the input and attach to the debugger and the press enter then observe it in debugger.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-Z9eqHRAGvGc/WDrG4twUAFI/AAAAAAAAFEo/h30cIj1Boe02WmhSe4OKNXq_z72rtxmaACLcB/s1600/5attach.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="212" src="https://2.bp.blogspot.com/-Z9eqHRAGvGc/WDrG4twUAFI/AAAAAAAAFEo/h30cIj1Boe02WmhSe4OKNXq_z72rtxmaACLcB/s640/5attach.PNG" width="640" /></a></div><br /><br />Bear in mind, this binary have several anti-debug trick, like IsDebuggerPresent, just patch it or use plugin.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-0pZHvIWgXVA/WDrG5dLL5uI/AAAAAAAAFEw/AiaDstfMY44hmWvNKcndnzxVqnrNazangCLcB/s1600/7step.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="350" src="https://2.bp.blogspot.com/-0pZHvIWgXVA/WDrG5dLL5uI/AAAAAAAAFEw/AiaDstfMY44hmWvNKcndnzxVqnrNazangCLcB/s640/7step.PNG" width="640" /></a></div>You need to step until you find re2 module like I circle in red, then  you can see the original code, you can dumped the code and rebuild the  PE file or just debug the code.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-f0jdwJKgnYw/WDrG5YuHPtI/AAAAAAAAFE0/i-r8DpvIOQEvY21bXZErTavp1bsJ8pUngCLcB/s1600/8cmp.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="70" src="https://1.bp.blogspot.com/-f0jdwJKgnYw/WDrG5YuHPtI/AAAAAAAAFE0/i-r8DpvIOQEvY21bXZErTavp1bsJ8pUngCLcB/s320/8cmp.PNG" width="320" /></a></div>&nbsp;It compared first 8 char one by one.<br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-SklIhRtuKto/WDrG58TXK1I/AAAAAAAAFE8/PzxZwrrHQMEbs4bq9f1eFQT88KAr-myXgCLcB/s1600/9reg.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-SklIhRtuKto/WDrG58TXK1I/AAAAAAAAFE8/PzxZwrrHQMEbs4bq9f1eFQT88KAr-myXgCLcB/s1600/9reg.PNG" /></a></div>Here we can see the register which compared our first 8 char with first 8char of the flag. Just copy and edit our input to the same one and you good to go for another part of the flag, doing it until you get the whole flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-7ozueaz4P1c/WDrG5qTu33I/AAAAAAAAFFE/x7hW3W3lA60-z1V1KYalX-JwQdfnhc_KgCEw/s1600/9checkeragain.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="179" src="https://1.bp.blogspot.com/-7ozueaz4P1c/WDrG5qTu33I/AAAAAAAAFFE/x7hW3W3lA60-z1V1KYalX-JwQdfnhc_KgCEw/s640/9checkeragain.PNG" width="640" /></a></div>The binary check again at the last part to make sure you not edit the input during debug, just skip or edit the input in memory<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-aMY5y5p6MmQ/WDrG33A8IQI/AAAAAAAAFEc/4N125LIfVqIQ54OrotK9ki0A6RTUFViwQCLcB/s1600/10flag.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="249" src="https://3.bp.blogspot.com/-aMY5y5p6MmQ/WDrG33A8IQI/AAAAAAAAFEc/4N125LIfVqIQ54OrotK9ki0A6RTUFViwQCLcB/s640/10flag.PNG" width="640" /></a></div>Try it with the whole flag and the you get the flag!<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Congratulations! It is correct... The flag is KPMG{S`/C&amp;0^X3660rkv,5wJ+Ce@(fa-s*m9f}</span><br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><i><span style="font-family: Times, &quot;Times New Roman&quot;, serif;">EDIT: Thanks to master jani for pointing out to remove ASLR before doing "upx -d" to prevent crashes after unpacking.</span></i></span></div>

	</article>






	<div class="postnavigation">

		
			<span class="nope left">&larr; Newer</span>
		

		<span class="pages">Page 1 of 4</span>

		
			<a class="next right" href="/page2/">Older &rarr;</a>
		

	</div>

    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2018 blog.najashark.net. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>